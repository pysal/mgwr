<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mgwr.sel_bw.Sel_BW &#8212; mgwr v2.2.1 Manual</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/pysal-styles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/pysal-styles.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="icon" href="../_static/pysal_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mgwr.utils.shift_colormap" href="mgwr.utils.shift_colormap.html" />
    <link rel="prev" title="mgwr.kernels.local_cdist" href="mgwr.kernels.local_cdist.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          mgwr</a>
        <span class="navbar-text navbar-version pull-left"><b>2.2.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../installation.html">Installation</a></li>
                <li><a href="../api.html">API</a></li>
                <li><a href="../references.html">References</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="mgwr-sel-bw-sel-bw">
<h1>mgwr.sel_bw.Sel_BW<a class="headerlink" href="#mgwr-sel-bw-sel-bw" title="Permalink to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mgwr.sel_bw.Sel_BW">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mgwr.sel_bw.</span></span><span class="sig-name descname"><span class="pre">Sel_BW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">coords:</span> <span class="pre">list[tuple],</span> <span class="pre">y:</span> <span class="pre">~numpy.array,</span> <span class="pre">X_loc:</span> <span class="pre">~numpy.array,</span> <span class="pre">X_glob:</span> <span class="pre">~numpy.array</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">family:</span> <span class="pre">~spglm.family.Gaussian</span> <span class="pre">=</span> <span class="pre">&lt;spglm.family.Gaussian</span> <span class="pre">object&gt;,</span> <span class="pre">offset:</span> <span class="pre">~numpy.array</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">kernel:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'bisquare',</span> <span class="pre">fixed:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">multi:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">constant:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">spherical:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mgwr/sel_bw.html#Sel_BW"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgwr.sel_bw.Sel_BW" title="Permalink to this definition">¶</a></dt>
<dd><p>Select bandwidth for kernel</p>
<p>Methods: p211 - p213, bandwidth selection</p>
<p><span id="id1">[<a class="reference internal" href="../references.html#id5" title="A. Stewart Fotheringham, Chris Brunsdon, and Martin Charlton. Geographically Weighted Regression: The Analysis of Spatially Varying Relationships. John Wiley &amp; Sons, February 2002. ISBN 978-0-470-85525-6.">FBC02</a>]</span>: Fotheringham, A. S., Brunsdon, C., &amp; Charlton, M. (2002).
Geographically weighted regression: the analysis of spatially varying relationships.</p>
<dl>
<dt>Args:</dt><dd><p>coords (list[tuple]): (x,y) of points used in bandwidth selection
y (np.array): n*1, dependent variable
X_loc (np.array): n*k2, local independent variable, including intercept
X_glob (np.array, optional): n*k1, fixed independent variable. Defaults to None.
family (Gaussian, optional): function object/instance,</p>
<blockquote>
<div><p>underlying probability model: Gaussian(), Poisson(), Binomial(). Defaults to Gaussian().</p>
</div></blockquote>
<dl class="simple">
<dt>offset (np.array, optional): n*1, the offset variable at the ith location.</dt><dd><p>For Poisson model this term is often the size of the population at risk
or the expected size of the outcome in spatial epidemiology.
Default is None where Ni becomes 1.0 for all locations</p>
</dd>
<dt>kernel (str, optional): kernel function: ‘gaussian’, ‘bisquare’, ‘exponential’.</dt><dd><p>Defaults to ‘bisquare’.</p>
</dd>
<dt>fixed (bool, optional): True for fixed bandwidth and False for adaptive (NN).</dt><dd><p>Defaults to False.</p>
</dd>
<dt>multi (bool, optional): True for multiple (covaraite-specific) bandwidths.</dt><dd><p>False for a traditional (same for  all covariates) bandwdith.
Defaults to False.</p>
</dd>
<dt>constant (bool, optional): True to include intercept (default) in model</dt><dd><p>and False to exclude intercept. Defaults to True.</p>
</dd>
<dt>spherical (bool, optional): True for shperical coordinates (long-lat),</dt><dd><p>False for projected coordinates (defalut).
Defaults to False.</p>
</dd>
</dl>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">libpysal</span> <span class="k">as</span> <span class="nn">ps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mgwr.sel_bw</span> <span class="kn">import</span> <span class="n">Sel_BW</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;GData_utm.csv&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">by_col</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">by_col</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">by_col</span><span class="p">(</span><span class="s1">&#39;PctBach&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rural</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">by_col</span><span class="p">(</span><span class="s1">&#39;PctRural&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">by_col</span><span class="p">(</span><span class="s1">&#39;PctPov&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">african_amer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">by_col</span><span class="p">(</span><span class="s1">&#39;PctBlack&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">rural</span><span class="p">,</span> <span class="n">pov</span><span class="p">,</span> <span class="n">african_amer</span><span class="p">])</span>
</pre></div>
</div>
<p>Golden section search AICc - adaptive bisquare</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">Sel_BW</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;AICc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bw</span><span class="p">)</span>
<span class="go">93.0</span>
</pre></div>
</div>
<p>Golden section search AIC - adaptive Gaussian</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">Sel_BW</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;AIC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bw</span><span class="p">)</span>
<span class="go">50.0</span>
</pre></div>
</div>
<p>Golden section search BIC - adaptive Gaussian</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">Sel_BW</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;BIC&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bw</span><span class="p">)</span>
<span class="go">62.0</span>
</pre></div>
</div>
<p>Golden section search CV - adaptive Gaussian</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">Sel_BW</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;CV&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bw</span><span class="p">)</span>
<span class="go">68.0</span>
</pre></div>
</div>
<p>Interval AICc - fixed bisquare</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sel</span> <span class="o">=</span> <span class="n">Sel_BW</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bw</span> <span class="o">=</span> <span class="n">sel</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">search_method</span><span class="o">=</span><span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="n">bw_min</span><span class="o">=</span><span class="mf">211001.0</span><span class="p">,</span> <span class="n">bw_max</span><span class="o">=</span><span class="mf">211035.0</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bw</span><span class="p">)</span>
<span class="go">211025.0</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mgwr.sel_bw.Sel_BW.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">coords:</span> <span class="pre">list[tuple],</span> <span class="pre">y:</span> <span class="pre">~numpy.array,</span> <span class="pre">X_loc:</span> <span class="pre">~numpy.array,</span> <span class="pre">X_glob:</span> <span class="pre">~numpy.array</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">family:</span> <span class="pre">~spglm.family.Gaussian</span> <span class="pre">=</span> <span class="pre">&lt;spglm.family.Gaussian</span> <span class="pre">object&gt;,</span> <span class="pre">offset:</span> <span class="pre">~numpy.array</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">kernel:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'bisquare',</span> <span class="pre">fixed:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">multi:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">constant:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">spherical:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.10/library/constants.html#None" title="(in Python v3.10)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/mgwr/sel_bw.html#Sel_BW.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mgwr.sel_bw.Sel_BW.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#mgwr.sel_bw.Sel_BW.__init__" title="mgwr.sel_bw.Sel_BW.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(coords, y, X_loc[, X_glob, family, ...])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">search</span></code>([search_method, criterion, bw_min, ...])</p></td>
<td><p>Method to select one unique bandwidth for a gwr model or a bandwidth vector for a mgwr model.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/generated/mgwr.sel_bw.Sel_BW.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2018, pysal developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.0.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>